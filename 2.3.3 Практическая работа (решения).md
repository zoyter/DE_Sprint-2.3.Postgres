### Практическая работа № 9 

1. Создать таблицу с основной информацией о сотрудниках: ФИО, дата рождения, дата начала работы, должность, уровень сотрудника (jun, middle, senior, lead), уровень зарплаты, идентификатор отдела, наличие/отсутствие прав(True/False). При этом в таблице обязательно должен быть уникальный номер для каждого сотрудника.

```sql
CREATE TABLE staff
(
    id SERIAL PRIMARY KEY,
    lastname character varying (30),
    firstname character varying (30),
    birthday date,
    startdate date,
    job_position character varying (30),
    job_level character varying (30),
    salary bigint,
    department  character varying (30),
    driver_lic boolean
);

INSERT INTO staff(lastname,firstname,birthday,startdate,job_position,job_level,salary,department,driver_lic)
VALUES
('Пётр','Первый','12.12.1970','программист','jun','100500','Тестирование',true),
('Пётр','Второй','13.12.1970','программист','middle','200500','Тестирование',true),
('Пётр','Третий','14.12.1970','программист','senior','300500','Разработка',false),
('Пётр','Четвертый','15.12.1970','программист','lead','400500','Тестирование',true),
('Пётр','Пятый','16.12.1970','программист','lead','400500','Тестирование',true);
```

2. Для будущих отчетов аналитики попросили вас создать еще одну таблицу с информацией по отделам – в таблице должен быть идентификатор для каждого отдела, название отдела (например. Бухгалтерский или IT отдел), ФИО руководителя и количество сотрудников.

```sql
CREATE TABLE departments
(
    id SERIAL PRIMARY KEY,
    dep_name character varying (30),
    dep_head character varying (100),
    staff_count bigint
);

INSERT INTO departments(dep_name,dep_head,staff_count)
VALUES
('Бухгалтерия','Петрова Мария Андреевна', 30),
('Разработка','Сидорова Ирина Андреевна', 300),
('Тестирование','Сидорова Ольга Андреевна', 300);
```

3. На кону конец года и необходимо выплачивать сотрудникам премию. Премия будет выплачиваться по совокупным оценкам, которые сотрудники получают в каждом квартале года. Создайте таблицу, в которой для каждого сотрудника будут его оценки за каждый квартал. Диапазон оценок от A – самая высокая, до E – самая низкая.

```sql
CREATE TABLE marks
(
    id SERIAL PRIMARY KEY,
    staff_name character varying (30),
    staff_mark  character varying (1),
);

INSERT INTO marks(staff_name,staff_mark)
VALUES
('Пётр', 'A'),
('Иван', 'B'),
('Илья', 'C'),
('Николай', 'D'),
('Фома', 'E');

```

4. Несколько уточнений по предыдущим заданиям – в первой таблице должны быть записи как минимум о 5 сотрудниках, которые работают как минимум в 2-х разных отделах. Содержимое соответствующих атрибутов остается на совесть вашей фантазии, но, желательно соблюдать осмысленность и правильно выбирать типы данных (для зарплаты – числовой тип, для ФИО – строковый и т.д.)

5. Ваша команда расширяется и руководство запланировало открыть новый отдел – отдел Интеллектуального анализа данных. На начальном этапе в команду наняли одного руководителя отдела и двух сотрудников. Добавьте необходимую информацию в соответствующие таблицы.

```sql
INSERT INTO departments(dep_name,dep_head,staff_count)
VALUES
('Интеллектуальный анализ данных','Лазарева Мария Андреевна', 3),

INSERT INTO staff(lastname,firstname,birthday,startdate,job_position,job_level,salary,department,driver_lic)
VALUES
('Лазарева','Мария','17.12.1970','программист','lead','400500','Интеллектуальный анализ данных',True),
('Иванов','Иван','17.12.1970','программист','jun','100500','Интеллектуальный анализ данных',True),
('Петров','Иван','27.12.1971','программист','jun','100500','Интеллектуальный анализ данных',True);

```

6. Теперь пришла пора анализировать наши данные – напишите запросы для получения следующей информации:

    6.1 Уникальный номер сотрудника, его ФИО и стаж работы – для всех сотрудников компании

```sql
SELECT id,lastname,firstname,startdate FROM departments;
```
    
    6.2 Уникальный номер сотрудника, его ФИО и стаж работы – только первых 3-х сотрудников
```sql
SELECT id,lastname,firstname,startdate FROM departments LIMIT 3;
```

    6.3 Уникальный номер сотрудников - водителей

```sql
SELECT id FROM staff WHERE driver_lic=true;
```

    6.4 Выведите номера сотрудников, которые хотя бы за 1 квартал получили оценку D или E

```sql
SELECT id FROM marks WHERE staff_mark='D' or staff_mark='E';
```

    6.5 Выведите самую высокую зарплату в компании.

```sql
SELECT max(salary) FROM staff;
```

    6.6 **Выведите название самого крупного отдела**

    6.7 **Выведите номера сотрудников от самых опытных до вновь прибывших**

    6.8 **Рассчитайте среднюю зарплату для каждого уровня сотрудников**

    6.9 **Добавьте столбец с информацией о коэффициенте годовой премии к основной таблице. Коэффициент рассчитывается по такой схеме: базовое значение коэффициента – 1, каждая оценка действует на коэффициент так:**

        - Е – минус 20%
        - D – минус 10%
        - С – без изменений
        - B – плюс 10%
        - A – плюс 20%
        Соответственно, сотрудник с оценками А, В, С, D – должен получить коэффициент 1.2.

Задачи со (*) - для обучающихся в группе 1Т ИД когорта Pro.

По итогам работы вам необходимо запушить код запросов к БД в отдельный репозиторий (github/gitlab) и приложить ссылку.


